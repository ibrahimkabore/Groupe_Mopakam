{% extends 'layouts/base.html' %}
{% block content %}
{% load static %}
{% load i18n %}
<main>
    <div class="container cont-contact">
        <div class="contact-section">
            <h2>üìû {% trans "CONTACTEZ-NOUS" %}</h2>
            <p>{% trans "VOUS AVEZ DES QUESTIONS OU SOUHAITEZ EN SAVOIR PLUS SUR NOS PRODUITS FERMIERS ? CONTACTEZ-NOUS D√àS AUJOURD'HUI ‚Äì NOTRE √âQUIPE EST L√Ä POUR VOUS AIDER AVEC PLAISIR !" %}</p>
            <p><strong>{% trans "T√©l√©phones :" %}</strong></p>
            <ul>
                <li>üìû+225 01 50 58 10 26</li>
                <li>üìû+225 05 84 27 08 08</li>
                <li>üìû+225 07 67 04 62 04</li>
            </ul>
            <p><strong>{% trans "Adresse :" %}</strong></p>
            <p>{% trans "AGBOVILLE - M'BERI√â, SOUS-PR√âFECTURE DE GRAND-MORI√â, C√îTE D'IVOIRE" %}</p>
            <p><strong>{% trans "Email :" %}</strong></p>
            <p>INFO@GROUPEMOPAKAM.COM</p>
        </div>

        <div class="form-section">
            <h3>üì© {% trans "Laissez-nous un message" %}</h3>
            <div class="social-icons">
                <a href="#"><img src="{% static 'images/imgs/logo/facebook.png' %}" alt="Facebook"></a>
                <a href="#"><img src="{% static 'images/imgs/logo/google.png' %}" alt="Google" class="logo_go"></a>
                <a href="#"><img src="{% static 'images/imgs/logo/linkedin.png' %}" alt="LinkedIn"></a>
            </div>
            <form method="post" action="{% url 'contact' %}" class="form">
                {% csrf_token %}
                <div class="form-group">
                    <label for="name">{% trans "Nom" %}</label>
                    <input type="text" id="name" name="name" placeholder="{% trans 'Nom' %}" required oninput="validateName()" maxlength="30" class="form-control">
                </div>
                <div class="form-group">
                    <label for="email">{% trans "E-mail" %}</label>
                    <input type="email" id="email" name="email" placeholder="{% trans 'E-mail' %}" required oninput="validateEmail()" class="form-control">
                </div>
                <div class="form-group">
                    <label for="countryCode">{% trans "Code pays" %}</label>
                    <select id="countryCode" name="countryCode" onchange="updatePhonePlaceholder()" class="form-control">
                        <option value="+225">C√¥te d'Ivoire (+225)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="phone">{% trans "T√©l√©phone" %}</label>
                    <input type="tel" id="phone" name="phone" placeholder="{% trans 'T√©l√©phone' %}" required pattern="\d{10}" inputmode="numeric" oninput="validatePhone()" maxlength="10" class="form-control">
                </div>
                <div class="form-group">
                    <label for="message">{% trans "Votre message" %}</label>
                    <textarea id="message" name="message" placeholder="{% trans 'Votre message' %}" required oninput="validateMessage()" maxlength="150" class="form-control"></textarea>
                </div>
                <div class="bouton">
                    <button type="submit" class="btn btn-primary">{% trans "Envoyer le message" %}</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Section Google Maps -->
    <div class="map-container">
        <h3>üìç {% trans "Localisation" %}</h3>
        <iframe 
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d15872.51880403325!2d-4.143776986431957!3d5.976871995267258!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0xfc11411d763c919%3A0xcf52b72f41c928a0!2sGrand%20Mori%C3%A9!5e0!3m2!1sfr!2sci!4v1740221218659!5m2!1sfr!2sci" 
            width="100%" 
            height="450" 
            style="border:0;" 
            allowfullscreen="" 
            loading="lazy" 
            referrerpolicy="no-referrer-when-downgrade">
        </iframe>
    </div>
</main>
<script>
    function updatePhonePlaceholder() {
      var phoneInput = document.getElementById('phone');
      var countryCode = document.getElementById('countryCode').value;
      phoneInput.placeholder = countryCode + " 00 00 00 00";
    }
    
    fetch('https://restcountries.com/v3.1/all')
    .then(response => response.json())
    .then(data => {
        const selectElement = document.getElementById('countryCode');
        data.forEach(country => {
        const code = country.idd ? country.idd.root + (country.idd.suffixes ? country.idd.suffixes[0] : '') : '';
        if (code) {
            const option = document.createElement('option');
            option.value = code;
            option.textContent = `${country.name.common} (${code})`;
            selectElement.appendChild(option);
        }
        });
    });

    function validateName() {
        let nameInput = document.querySelector('input[name="name"]');
        nameInput.value = nameInput.value.replace(/[^a-zA-Z\s]/g, ''); // Supprimer tout sauf les lettres et les espaces
        if (nameInput.value.length > 30) {
            nameInput.value = nameInput.value.slice(0, 30);
        }
    }
    
    function validateEmail() {
        let emailInput = document.querySelector('input[name="email"]');
        // Supprimer tous les caract√®res non valides (ceux qui ne sont pas dans une adresse email standard)
        emailInput.value = emailInput.value.replace(/[^a-zA-Z0-9@._-]/g, '');
    }
    
    function validatePhone() {
        let phoneInput = document.getElementById('phone');
        // Remplacer tout sauf les chiffres
        phoneInput.value = phoneInput.value.replace(/[^0-9]/g, '');
       
        // Limiter la saisie √† 10 chiffres
        if (phoneInput.value.length > 10) {
            phoneInput.value = phoneInput.value.slice(0, 10);
        }
    }
    
    function validateMessage() {
        let messageInput = document.querySelector('textarea[name="message"]');
        // Limiter la longueur √† 150 caract√®res
        if (messageInput.value.length > 150) {
            messageInput.value = messageInput.value.slice(0, 150);
        }
    }
</script>
{% endblock %}
